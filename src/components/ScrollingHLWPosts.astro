---
// src/components/ScrollingHLWPosts.astro
// ä»Markdownæ–‡ä»¶è·å–æ•°æ®
const allPosts = Object.values(
    import.meta.glob("../pages/post/*.md", { eager: true }),
);
// ç­›é€‰å‡ºåŒ…å«"hlw"åˆ†ç±»çš„æ–‡ç« 
const hlwPosts = allPosts
    .filter((post) => {
        const categories = post.frontmatter.categories || [];
        return categories.includes("hlw");
    })
    // æŒ‰æ—¥æœŸæ’åºï¼ˆæœ€æ–°çš„åœ¨å‰ï¼‰
    .sort((a, b) => new Date(b.frontmatter.date) - new Date(a.frontmatter.date))
    // å–æœ€æ–°çš„10ç¯‡
    .slice(0, 10);
---

<div class="scrolling-banner">
    <div class="scrolling-content" id="scrolling-content">
        {
            hlwPosts.length > 0 ? (
                hlwPosts.map((post) => (
                    <a href={post.url} class="post-link">
                        {post.frontmatter.title}
                    </a>
                ))
            ) : (
                <span class="post-link">ğŸ“„ æš‚æ— æœ€æ–°ç§‘æŠ€æ–‡ç« </span>
            )
        }
    </div>
</div>

<style>
    .scrolling-banner {
        width: 100%;
        height: 40px;
        background: white;
        border: 1px solid #e5e7eb;
        overflow: hidden;
        position: relative;
        display: flex;
        align-items: center;
    }

    .scrolling-content {
        display: flex;
        align-items: center;
        height: 100%;
        white-space: nowrap;
        animation: scroll-infinite 60s linear infinite;
    }

    .post-link {
        color: #374151;
        text-decoration: none;
        font-weight: 500;
        font-size: 14px;
        margin-right: 80px;
        transition: color 10s ease;
        flex-shrink: 0;
    }

    .post-link:hover {
        color: #3b82f6;
    }

    @keyframes scroll-infinite {
        0% {
            transform: translateX(0);
        }
        100% {
            transform: translateX(-50%);
        }
    }

    .scrolling-banner:hover .scrolling-content {
        animation-play-state: paused;
    }
</style>

<script>
    document.addEventListener("DOMContentLoaded", () => {
        const container = document.getElementById("scrolling-content");
        if (!container) return;

        // è·å–åŸå§‹å†…å®¹
        const originalContent = container.innerHTML;

        // å¤åˆ¶å†…å®¹å¤šæ¬¡ä»¥ç¡®ä¿æ— ç¼å¾ªç¯
        // å¤åˆ¶è¶³å¤Ÿå¤šçš„æ¬¡æ•°ä»¥å¡«æ»¡å±å¹•å¹¶ç¡®ä¿æ— ç¼æ»šåŠ¨
        const repeatCount = 10; // å¯ä»¥æ ¹æ®éœ€è¦è°ƒæ•´
        let repeatedContent = "";

        for (let i = 0; i < repeatCount; i++) {
            repeatedContent += originalContent;
        }

        container.innerHTML = repeatedContent;

        // ç¡®ä¿åŠ¨ç”»ä»å†…å®¹å¯è§çš„ä½ç½®å¼€å§‹
        container.style.transform = "translateX(0)";
    });
</script>
