---
// src/components/Paginator.astro
// 分页导航组件

export interface Props {
    currentPage: number;
    totalPages: number;
    baseUrl: string; // 基础URL，如 /tags/astro 或 /categories/hlw
}

const { currentPage, totalPages, baseUrl } = Astro.props;

// 生成页码数组
function generatePageNumbers(current: number, total: number) {
    const pages = [];
    const showPages = 5; // 显示的页码数量

    if (total <= showPages) {
        // 如果总页数小于等于显示页数，显示所有页码
        for (let i = 1; i <= total; i++) {
            pages.push(i);
        }
    } else {
        // 否则显示当前页周围的页码
        let start = Math.max(1, current - Math.floor(showPages / 2));
        let end = Math.min(total, start + showPages - 1);

        // 调整开始位置以确保显示足够的页码
        if (end - start < showPages - 1) {
            start = Math.max(1, end - showPages + 1);
        }

        for (let i = start; i <= end; i++) {
            pages.push(i);
        }
    }

    return pages;
}

const pageNumbers = generatePageNumbers(currentPage, totalPages);
---

<nav class="flex items-center justify-center space-x-2" aria-label="分页导航">
    <!-- 第一页 -->
    {currentPage > 1 && (
        <a
            href={`${baseUrl}/1`}
            class="inline-flex items-center px-3 py-2 text-sm font-medium text-gray-500 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 hover:text-gray-700 transition-colors"
            aria-label="第一页"
        >
            <svg class="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 19l-7-7 7-7m8 14l-7-7 7-7"></path>
            </svg>
            首页
        </a>
    )}

    <!-- 上一页 -->
    {currentPage > 1 && (
        <a
            href={`${baseUrl}/${currentPage - 1}`}
            class="inline-flex items-center px-3 py-2 text-sm font-medium text-gray-500 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 hover:text-gray-700 transition-colors"
            aria-label="上一页"
        >
            <svg class="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
            </svg>
            上一页
        </a>
    )}

    <!-- 页码 -->
    <div class="flex space-x-1">
        {pageNumbers.map((pageNum) => (
            pageNum === currentPage ? (
                <span
                    class="inline-flex items-center px-4 py-2 text-sm font-semibold text-white bg-indigo-600 border border-indigo-600 rounded-lg"
                    aria-current="page"
                >
                    {pageNum}
                </span>
            ) : (
                <a
                    href={`${baseUrl}/${pageNum}`}
                    class="inline-flex items-center px-4 py-2 text-sm font-medium text-gray-500 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 hover:text-gray-700 transition-colors"
                >
                    {pageNum}
                </a>
            )
        ))}
    </div>

    <!-- 下一页 -->
    {currentPage < totalPages && (
        <a
            href={`${baseUrl}/${currentPage + 1}`}
            class="inline-flex items-center px-3 py-2 text-sm font-medium text-gray-500 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 hover:text-gray-700 transition-colors"
            aria-label="下一页"
        >
            下一页
            <svg class="w-4 h-4 ml-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
            </svg>
        </a>
    )}

    <!-- 最后一页 -->
    {currentPage < totalPages && (
        <a
            href={`${baseUrl}/${totalPages}`}
            class="inline-flex items-center px-3 py-2 text-sm font-medium text-gray-500 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 hover:text-gray-700 transition-colors"
            aria-label="最后一页"
        >
            末页
            <svg class="w-4 h-4 ml-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 5l7 7-7 7m-8-14l7 7-7 7"></path>
            </svg>
        </a>
    )}
</nav>

<!-- 分页信息 -->
<div class="flex items-center justify-center mt-4 text-sm text-gray-500">
    <span>
        第 {currentPage} 页，共 {totalPages} 页
    </span>
</div>

<style>
    nav {
        font-family: 'Inter', ui-sans-serif, system-ui, sans-serif;
    }
</style>
